ID,Reference,Requirement
1,"Section 4.152","Requirement : Verify that a Commissioner can discover Nodes currently in Commissioning Mode by browsing for the _CM subtype using avahi-browse _CM._sub._matterc._udp -r or equivalent tools. [CM]"
2,"Section 4.155","Requirement : Verify that, during DNS-SD over Multicast DNS, the client stores additional records (SRV, TXT, and address) received in the Additional Record section of the reply to avoid redundant network operations. [DNS-SD]"
3,"Section 4.156","Requirement : Verify that the device can establish a cryptographically secure application-layer communication channel and that only secured channels are used for operational communication. [Security]"
4,"Section 4.156","Requirement : Verify that application-layer end-to-end security is enforced to detect and prevent malicious devices from establishing secure communication if fraudulent replies are given during Multicast DNS discovery."
5,"Section 6.242","Requirement : Verify that access to a Node’s Targets is denied unless the Access Control system explicitly grants the required privilege to a given Subject. [ACL]"
6,"Section 6.244","Requirement : Verify that all attempted access to a Node's Targets is checked against Access Control Entries in the Node’s Access Control List and Access Restriction List. [ACL, ARL]"
7,"Section 6.244","Requirement : Verify that only Administrative Subjects are implicitly granted administrative access privileges during a Node’s commissioning phase over the commissioning channel, except for items listed in the Commissioning Access Restriction List. [PASE, ARL]"
8,"Section 6.245","Requirement : Verify that each Access Control Entry in the ACL contains a FabricIndex, Privilege level, AuthMode, list of target Clusters, and list of source Subjects. [ACE]"
9,"Section 6.261","Requirement : Verify that a Node denies CASE session establishment from an initiator whose identity does not match any Access Control Entry, if this constraint is implemented. [CASE]"
10,"Section 6.270","Requirement : Verify that an Access Control Entry with privilege level 'Administer' must have AuthMode set to 'CASE' and not 'Group'. [Administer, CASE]"
11,"Section 6.272","Requirement : Verify that after Factory Data Reset, the Access Control List (ACL) is empty and has no entries. [ACL]"
12,"Section 6.273","Requirement : Verify that during PASE commissioning, the Commissioner is implicitly granted Administer privilege for the entire node over the PASE channel. [PASE]"
13,"Section 6.274","Requirement : Verify that after the AddNOC command during commissioning, an Access Control Entry is created granting Administer privilege using CASE authenticated Subject for the entire Node. [AddNOC, CASE]"
14,"Section 6.283","Requirement : Verify that when granting privileges to a group using a CAT-based subject, only Nodes with the appropriate CAT identifier value and version receive the privilege. [CAT]"
15,"Section 6.285","Requirement : Verify that updating the CAT version in NOCs and ACL entries removes group privileges from Nodes with an older CAT version and confers privilege only to Nodes with a matching or higher CAT version. [CAT]"
16,"Section 6.265","Requirement : Verify that the device preserves every field of the installed Access Control Cluster, including any installed extensions, unmodified, so that they may be read back verbatim by an Administrator. [Extension]"
17,"Section 6.266","Requirement : Verify that the Access Control Cluster is not used to encode application-level permissions and configurations, such as smart lock PIN codes or similar user-facing security functions. [Application-level security]"
18,"Section 6.267","Requirement : Verify that restrictions imposed by the Access Restriction List take precedence over permissions granted in the Access Control List for the same attributes, commands, or events. [ARL]"
19,"Section 11.1637","Requirement : Verify that only Joint Fabric Anchor Administrator Nodes expose the Joint Fabric Datastore Cluster server, and it is not accessible otherwise. [JFDA]"
20,"Section 11.1638","Requirement : Verify that Admin level access to the Joint Fabric Datastore Cluster server is limited to Joint Fabric Administrator Nodes identified using the Administrator CAT. [JFDA, CAT]"
21,"Section 11.1643","Requirement : Verify that adding a Node to the Joint Fabric involves first adding a node entry to the datastore with 'pending' status and then marking it 'committed' using the RefreshNode command after commissioning completes. [AddPendingNode, RefreshNode]"
22,"Section 11.1647","Requirement : Verify that when removing a Node from the Joint Fabric, privileges are first revoked and then the Node Information Entry is removed from the Joint Fabric Datastore using the RemoveNode command. [RemoveNode]"
23,"Section 11.1648","Requirement : Verify that the Datastore reviews pending and pending deletion state entries and attempts to apply updates to Nodes, especially for group key, membership, ACL, and binding changes. [Pending]"
24,"Section 11.1651","Requirement : Verify that adding a Node to a Group using AddGroupIDToEndpointForNode updates the Node with the specified group key and membership configuration. [Group, AddGroupIDToEndpointForNode]"
25,"Section 11.1654","Requirement : Verify that when group membership was used for control of the Node, RemoveACLFromNode command is used to remove the ACL from the Node. [RemoveACLFromNode]"
26,"Section 11.24.7.10, AddPendingNode Command","Requirement : Verify that when adding a Node to the Joint Fabric Datastore, the AddPendingNode command is used and sets the CommissioningStatusEntry to Pending. [AddPendingNode]"
27,"Section 11.24.7.10, AddPendingNode Command","Requirement : Verify that if a Node Information Entry already exists for the given NodeID, the AddPendingNode command fails with an INVALID_CONSTRAINT status code. [AddPendingNode]"
28,"Section 11.24.4.2, Removing a Node from the Joint Fabric","Requirement : Verify that the Commissioner removes the pending node from the Datastore using the RemoveNode command if the finalize commissioning step fails. [RemoveNode]"
29,"Section 11.1646","Requirement : Verify that after successful commissioning completion, the Commissioner calls the RefreshNode command to indicate completion. [RefreshNode]"
30,"Section 11.24.4.2, Removing a Node from the Joint Fabric","Requirement : Verify that when removing a Node from the Joint Fabric, Node access privileges are removed before removing the Node Information Entry from the Datastore. [RemoveNode]"
31,"Section 11.24.4.3, Pending Data Cleanup","Requirement : Verify that the Datastore periodically reviews Pending and PendingDeletion states and attempts to update the corresponding Node. [Pending, PendingDeletion]"
32,"Section 11.24.4.3, Pending Data Cleanup","Requirement : Verify that administrators can invoke the RefreshNode command to have the Datastore immediately attempt to apply pending or pending deletion updates for a node. [RefreshNode]"
33,"Section 11.24.4.4, Adding a Node to a Group","Requirement : Verify that when adding a Node to a Group with GroupKeySetID, the AddGroupIDToEndpointForNode command must be used to update the Node with the KeySet and Group relationship. [AddGroupIDToEndpointForNode]"
34,"Section 11.24.4.4, Adding a Node to a Group","Requirement : Verify that when Group membership is for control of the Node, AddACLToNode command is used to update the Node with the appropriate ACL. [AddACLToNode]"
35,"Section 11.24.4.4, Adding a Node to a Group","Requirement : Verify that when Group membership is for control by the Node, AddBindingToEndpointForNode command is used to update the Node with the appropriate Binding. [AddBindingToEndpointForNode]"
36,"Section 11.24.4.5, Removing a Node from a Group","Requirement : Verify that when removing a Node from a Group where membership was for control of the Node, RemoveACLFromNode command is used to remove the ACL from the Node. [RemoveACLFromNode]"
37,"Section 11.24.4.5, Removing a Node from a Group","Requirement : Verify that when removing a Node from a Group where membership was for control by the Node, RemoveBindingFromEndpointForNode command is used to remove the Binding from the Node. [RemoveBindingFromEndpointForNode]"
38,"Section 11.24.4.5, Removing a Node from a Group","Requirement : Verify that when removing a Node from a Group with GroupKeySetID set, RemoveGroupIDFromEndpointForNode command is used to update the Node and the Datastore. [RemoveGroupIDFromEndpointForNode]"
39,"Section 11.24.7.5, UpdateGroup Command","Requirement : Verify that if a group update changes the GroupKeySetID, a DatastoreNodeKeySetEntryStruct is added with Status set to Pending, and the KeySet is added to the Node. [GroupKeySetID, Pending]"
40,"Section 11.24.7.5, UpdateGroup Command","Requirement : Verify that pending changes resulting from failed updates to a Node are applied in subsequent Node Refresh operations. [RefreshNode, Pending]"
41,"Sections 11.24.7.3, 11.24.7.6 RemoveKeySet and RemoveGroup Commands","Requirement : Verify that attempts to remove KeySets or Groups that are in use (not DeletePending) fail with CONSTRAINT_ERROR status code. [RemoveKeySet, RemoveGroup, DeletePending]"
42,"Section 11.24.7.3, RemoveKeySet Command","Requirement : Verify that attempts to remove the IPK (GroupKeySetID of 0) with RemoveKeySet fails with CONSTRAINT_ERROR status code. [RemoveKeySet]"
43,"Section 11.24.5.9, DatastoreEndpointEntryStruct","Requirement : Verify that updates to FriendlyName or group membership involving endpoints must follow the pending → committed workflow with the current state reflected in the Status Entry. [Pending, Committed]"
44,"Section 11.24.5.14, DatastoreNodeInformationEntryStruct","Requirement : Verify that each new Node Information Entry is initialized with CommissioningStatusEntry set to Pending, and changes to Committed or CommitFailed as commissioning completes or fails."
45,"Section 11.24.6.8, AdminList Attribute","Requirement : Verify that only one Administrator may serve as the Anchor Root CA and Anchor Fabric Administrator and that this Administrator appears at index 0 in the AdminList."
46,"Section 11.24.7.9, RemoveAdmin Command [11.1790]","Requirement : Verify that the RemoveAdmin command fails with a NOT_FOUND status code if the entry for the given NodeID does not exist. [RemoveAdmin]"
47,"Section 11.24.7.10, AddPendingNode Command [11.1795]","Requirement : Verify that the AddPendingNode command fails with an INVALID_CONSTRAINT status code if a Node Information Entry already exists for the given NodeID. [AddPendingNode]"
48,"Section 11.24.7.11, RefreshNode Command [11.1798]","Requirement : Verify that the RefreshNode command fails with a NOT_FOUND status code if a Node Information Entry does not exist for the given NodeID. [RefreshNode]"
49,"Section 11.24.7.12, UpdateNode Command [11.1802]","Requirement : Verify that the UpdateNode command fails with a NOT_FOUND status code if a Node Information Entry does not exist for the given NodeID. [UpdateNode]"
50,"Section 11.24.7.13, RemoveNode Command [11.1805]","Requirement : Verify that the RemoveNode command fails with a NOT_FOUND status code if a Node Information Entry does not exist for the given NodeID. [RemoveNode]"
51,"Section 11.24.7.14, UpdateEndpointForNode Command [11.1810]","Requirement : Verify that the UpdateEndpointForNode command fails with a NOT_FOUND status code if an Endpoint Information Entry does not exist for the given NodeID and EndpointID. [UpdateEndpointForNode]"
52,"Section 11.24.7.15, AddGroupIDToEndpointForNode Command [11.1816]","Requirement : Verify that the AddGroupIDToEndpointForNode command fails with a NOT_FOUND status code if an Endpoint Information Entry does not exist for the given NodeID and EndpointID. [AddGroupIDToEndpointForNode]"
53,"Section 11.24.7.16, RemoveGroupIDFromEndpointForNode Command [11.1822]","Requirement : Verify that the RemoveGroupIDFromEndpointForNode command fails with a NOT_FOUND status code if an Endpoint Information Entry does not exist for the given NodeID and EndpointID. [RemoveGroupIDFromEndpointForNode]"
54,"Section 11.24.7.17, AddBindingToEndpointForNode Command [11.1828]","Requirement : Verify that the AddBindingToEndpointForNode command fails with a NOT_FOUND status code if an Endpoint Information Entry does not exist for the given NodeID and EndpointID. [AddBindingToEndpointForNode]"
55,"Section 11.24.7.18, RemoveBindingFromEndpointForNode Command [11.1834]","Requirement : Verify that the RemoveBindingFromEndpointForNode command fails with a NOT_FOUND status code if an Endpoint Information Entry does not exist for the given NodeID and EndpointID. [RemoveBindingFromEndpointForNode]"
56,"Section 11.24.7.19, AddACLToNode Command [11.1839]","Requirement : Verify that the AddACLToNode command fails with a NOT_FOUND status code if a Node Information Entry does not exist for the given NodeID. [AddACLToNode]"
57,"Section 11.24.7.20, RemoveACLFromNode Command [11.1844]","Requirement : Verify that the RemoveACLFromNode command fails with a NOT_FOUND status code if a Node Information Entry does not exist for the given NodeID. [RemoveACLFromNode]"
58,"Section 11.25.7.1, ICACCSRRequest Command [11.1854]","Requirement : Verify that the ICACCSRRequest command fails with an INVALID_COMMAND status code if it is not received over a CASE session. [ICACCSRRequest]"
59,"Section 11.25.7.3, AddICAC Command [11.1866]","Requirement : Verify that the AddICAC command fails with an INVALID_COMMAND status code if it is not received over a CASE session. [AddICAC]"
60,"Section 11.25.7.5, OpenJointCommissioningWindow Command [11.1874]","Requirement : Verify that the OpenJointCommissioningWindow command fails with a InvalidAdministratorFabricIndex status code if the AdministratorFabricIndex attribute is null. [OpenJointCommissioningWindow]"
61,"Section 11.26.6.1, RequestCommissioningApproval Command [11.1889]","Requirement : Verify that the RequestCommissioningApproval command fails with a status code of UNSUPPORTED_ACCESS if not executed via a CASE session. [RequestCommissioningApproval]"
62,"Section 11.26.6.5, CommissionNode Command [11.1900]","Requirement : Verify that the CommissionNode command fails with a status code of UNSUPPORTED_ACCESS if not executed via a CASE session. [CommissionNode]"